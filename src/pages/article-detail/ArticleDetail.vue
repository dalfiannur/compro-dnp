<script setup lang="ts">
import { computed, onMounted } from 'vue';
import HowToFind from '../../components/HowToFind.vue'
import useGetQuery from "../../composable/useGetQuery";
import { Article } from "../../typings/Article";
import { useRoute } from 'vue-router'

const route = useRoute();
const { fetcher, data } = useGetQuery<Article>('articles');
const tags = computed(() => data.value ? data.value.tags.map((item) => '#' + item.name).join(' - ') : '');

onMounted(() => {
  const slug = location.pathname.split('articles/')[1] || '';
  fetcher(slug)
});

const generateDate = (dateString: string) => {
  const date = new Date(dateString);
  const options: Intl.DateTimeFormatOptions = {
    day: 'numeric',
    month: 'short',
    year: 'numeric'
  };
  return Intl.DateTimeFormat('ID-id', options).format(date);
}
</script>

<template>
  <div v-if="data" class="flex justify-center">
    <div class="flex-1 max-w-screen-xl">
      <div class="pt-10 text-center text-gray-1 font-questrial">
        <h1>Published {{ generateDate(data.createdAt) }} - by {{ data.user.name }}</h1>
      </div>
      <div class="pt-5 font-questrial text-hydrate text-xl md:text-6xl text-center">
        <h2>{{ data.title }}</h2>
      </div>
      <div class="pt-10 font-questrial tracking-[10px] text-center text-hydrate">
        <p class="uppercase">{{ tags }}</p>
      </div>

      <div class="mt-[50px]">
        <img :src="data.thumbnailUrl" class="w-full aspect-[16/9] object-cover" />
      </div>
      <div class="pt-10 flex justify-center">
        <div class="flex-1 max-w-screen-lg">
          <div class="pt-5 text-justify text-baseColor font-questrial" v-html="data.content" />
        </div>
      </div>
      <div class="pt-10 flex gap-5 justify-center items-center">
        <h6 class="flex justify-center md:justify-start text-baseColor font-questrial">Share this article</h6>
        <div class="flex gap-2">
          <a href="#!" type="button"
            class="leading-normal uppercase transition duration-150 ease-in-out hover:bg-opacity-5 focus:outline-none focus:ring-0 w-9 h-9">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 51.23 51.25">
              <path class="fill-hydrate" d="M51.23,24v3.1c0,.16-.07.32-.09.48-.14,1-.23,2-.42,3A25.57,25.57,0,0,1,30,50.85c-.93.16-1.87.27-2.81.4H24a2.62,2.62,0,0,0-.38-.09A25,25,0,0,1,17,49.74,25.61,25.61,0,1,1,38.45,3.48,24.89,24.89,0,0,1,50.84,21.26C51,22.17,51.1,23.1,51.23,24ZM27.32,22.44c0-1.21,0-2.32,0-3.44A1.67,1.67,0,0,1,29,17.22c.71-.06,1.43,0,2.14-.06.56,0,.79-.23.8-.8,0-.91,0-1.83,0-2.75,0-.56-.25-.79-.8-.79-1.05,0-2.11,0-3.15,0a5.24,5.24,0,0,0-5.3,4.76c-.17,1.39-.1,2.82-.13,4.24,0,.19,0,.39,0,.62H20c-.61,0-.85.24-.86.85v1.6c0,2.8-.32,2.44,2.44,2.46H22.6V28c0,3.22,0,6.44,0,9.66,0,.69.09.78.77.79h3.1c.73,0,.84-.11.84-.83V27.39l.55,0H30.6c.91,0,1-.11,1.13-1s.2-1.82.32-2.73S32,22.44,31,22.44Z"/>
              <path class="fill-white" d="M27.32,22.44H31c1,0,1.18.21,1.06,1.18s-.23,1.82-.32,2.73-.22,1-1.13,1H27.85l-.55,0V37.61c0,.72-.11.83-.84.83h-3.1c-.68,0-.77-.1-.77-.79,0-3.22,0-6.44,0-9.66v-.63H21.55c-2.76,0-2.42.34-2.44-2.46V23.3c0-.61.25-.84.86-.85h2.62c0-.23,0-.43,0-.62,0-1.42,0-2.85.13-4.24A5.24,5.24,0,0,1,28,12.83c1,0,2.1,0,3.15,0,.55,0,.79.23.8.79,0,.92,0,1.84,0,2.75,0,.57-.24.78-.8.8-.71,0-1.43,0-2.14.06A1.67,1.67,0,0,0,27.32,19C27.29,20.12,27.32,21.23,27.32,22.44Z"/>
            </svg>
          </a>

          <a href="#!" type="button"
            class="leading-normal uppercase transition duration-150 ease-in-out hover:bg-opacity-5 focus:outline-none focus:ring-0 w-9 h-9">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 51.21 51.23">
              <path class="fill-hydrate" d="M27.19,51.23H24a2.57,2.57,0,0,0-.38-.08A24.71,24.71,0,0,1,8.85,45,25,25,0,0,1,.12,23,24.21,24.21,0,0,1,6.4,8.68,25,25,0,0,1,25.16,0a24.25,24.25,0,0,1,13.53,3.6A25.26,25.26,0,0,1,50.81,21.2c.18.93.27,1.87.4,2.81v3.2c-.05.33-.09.66-.13,1a25.66,25.66,0,0,1-21,22.63C29.11,51,28.15,51.1,27.19,51.23ZM10.8,25.63c.1,2.43.1,4.89.3,7.33a7.55,7.55,0,0,0,6.6,7,39.33,39.33,0,0,0,5.64.3c3.18,0,6.37,0,9.54-.21a7.4,7.4,0,0,0,6.47-4.44,9.06,9.06,0,0,0,.84-3.79q.08-5.17.09-10.35a31.83,31.83,0,0,0-.19-3.24,7.62,7.62,0,0,0-6.61-7,40,40,0,0,0-5.59-.29c-3.2,0-6.4,0-9.59.2a7.61,7.61,0,0,0-7.2,7.18C10.9,20.74,10.9,23.18,10.8,25.63Z"/>
              <path class="fill-white" d="M10.8,25.63c.1-2.45.1-4.89.3-7.32a7.61,7.61,0,0,1,7.2-7.18c3.19-.22,6.39-.2,9.59-.2a40,40,0,0,1,5.59.29,7.62,7.62,0,0,1,6.61,7,31.83,31.83,0,0,1,.19,3.24q0,5.18-.09,10.35a9.06,9.06,0,0,1-.84,3.79,7.4,7.4,0,0,1-6.47,4.44c-3.17.22-6.36.21-9.54.21A39.33,39.33,0,0,1,17.7,40a7.55,7.55,0,0,1-6.6-7C10.9,30.52,10.9,28.06,10.8,25.63ZM25.58,13.51v.06c-1.1,0-2.2,0-3.3,0s-2.23,0-3.34.12c-3.11.22-5.14,2.13-5.22,5.24q-.18,6.68,0,13.35a5,5,0,0,0,5.22,5.21q6.65.18,13.3,0a5.06,5.06,0,0,0,5.25-5.24q.17-6.67,0-13.35a5.11,5.11,0,0,0-5.2-5.2C30,13.58,27.81,13.57,25.58,13.51Z"/>
              <path class="fill-hydrate" d="M25.58,13.51c2.23.06,4.46.07,6.69.2a5.11,5.11,0,0,1,5.2,5.2q.18,6.68,0,13.35a5.06,5.06,0,0,1-5.25,5.24q-6.64.18-13.3,0a5,5,0,0,1-5.22-5.21q-.18-6.67,0-13.35c.08-3.11,2.11-5,5.22-5.24,1.11-.08,2.23-.1,3.34-.12s2.2,0,3.3,0Zm7.56,12.1a7.55,7.55,0,1,0-7.57,7.55A7.55,7.55,0,0,0,33.14,25.61Zm2.06-7.8a1.76,1.76,0,1,0-1.83,1.71A1.76,1.76,0,0,0,35.2,17.81Z"/>
              <path class="fill-white" d="M33.14,25.61a7.55,7.55,0,1,1-7.53-7.55A7.54,7.54,0,0,1,33.14,25.61Zm-7.56,4.9a4.9,4.9,0,1,0-4.89-4.9A4.9,4.9,0,0,0,25.58,30.51Z"/>
              <path class="fill-white" d="M35.2,17.81A1.76,1.76,0,1,1,33.51,16,1.75,1.75,0,0,1,35.2,17.81Z"/>
              <path class="fill-hydrate" d="M25.58,30.51a4.9,4.9,0,1,1,4.91-4.87A4.91,4.91,0,0,1,25.58,30.51Z"/>
            </svg>
          </a>

          <a href="#!" type="button"
            class="leading-normal uppercase transition duration-150 ease-in-out hover:bg-opacity-5 focus:outline-none focus:ring-0 w-9 h-9">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 51.23 51.25">
              <path class="fill-hydrate" d="M27.21,51.25H24a2.34,2.34,0,0,0-.38-.09A25,25,0,0,1,17,49.74,25.61,25.61,0,1,1,38.45,3.48,24.93,24.93,0,0,1,50.84,21.26c.17.91.26,1.84.39,2.77v3.1c0,.16-.07.32-.09.48-.14,1-.23,2-.42,3A25.57,25.57,0,0,1,30,50.85C29.09,51,28.15,51.12,27.21,51.25ZM19.53,31.7A7.46,7.46,0,0,1,16.72,33c-1.1.23-2.24.28-3.36.44a.75.75,0,0,0-.51.34c0,.1.16.34.29.5a.87.87,0,0,0,.3.17A14.8,14.8,0,0,0,27,34.94c5.62-2.57,8.39-7.22,8.83-13.31a2.27,2.27,0,0,1,.78-1.73A16.43,16.43,0,0,0,38.24,18c.09-.11.06-.32.09-.48a1.63,1.63,0,0,0-.49,0c-.48.15-1,.33-1.38.48.39-.69.79-1.35,1.14-2,.08-.14,0-.36,0-.55a2.85,2.85,0,0,0-.51.08c-.72.29-1.44.6-2.16.91a1.12,1.12,0,0,1-1.23-.25A5.54,5.54,0,0,0,26,17a5.29,5.29,0,0,0-1.19,3.86c0,.37-.08.54-.47.48s-.69-.09-1-.16a14.36,14.36,0,0,1-8.47-4.91c-.41-.47-.54-.45-.81.09a5.47,5.47,0,0,0-.54,3.3,6.21,6.21,0,0,0,1.42,3.06,5.06,5.06,0,0,1-.88-.3c-.53-.24-.67-.16-.64.42A5.43,5.43,0,0,0,16,27.31l.46.31a3.77,3.77,0,0,1-.51,0c-.79-.08-.88,0-.57.75A5.64,5.64,0,0,0,19.53,31.7Z"/>
              <path class="fill-white" d="M19.53,31.7a5.64,5.64,0,0,1-4.17-3.34c-.31-.72-.22-.83.57-.75a3.77,3.77,0,0,0,.51,0L16,27.31a5.43,5.43,0,0,1-2.61-4.48c0-.58.11-.66.64-.42a5.06,5.06,0,0,0,.88.3,6.21,6.21,0,0,1-1.42-3.06,5.47,5.47,0,0,1,.54-3.3c.27-.54.4-.56.81-.09a14.36,14.36,0,0,0,8.47,4.91c.35.07.7.1,1,.16s.49-.11.47-.48A5.29,5.29,0,0,1,26,17a5.54,5.54,0,0,1,7.71-.82,1.12,1.12,0,0,0,1.23.25c.72-.31,1.44-.62,2.16-.91a2.85,2.85,0,0,1,.51-.08c0,.19.08.41,0,.55-.35.69-.75,1.35-1.14,2,.42-.15.9-.33,1.38-.48a1.63,1.63,0,0,1,.49,0c0,.16,0,.37-.09.48a16.43,16.43,0,0,1-1.66,1.86,2.27,2.27,0,0,0-.78,1.73c-.44,6.09-3.21,10.74-8.83,13.31a14.8,14.8,0,0,1-13.53-.49.87.87,0,0,1-.3-.17c-.13-.16-.34-.4-.29-.5a.75.75,0,0,1,.51-.34c1.12-.16,2.26-.21,3.36-.44A7.46,7.46,0,0,0,19.53,31.7Z"/>
            </svg>
          </a>

          <a href="#!" type="button"
            class="leading-normal uppercase transition duration-150 ease-in-out hover:bg-opacity-5 focus:outline-none focus:ring-0 w-9 h-9">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 51.23 51.26">
              <path class="fill-hydrate" d="M27.22,51.26H24a1.32,1.32,0,0,0-.33-.08,23.24,23.24,0,0,1-6.34-1.31Q3.38,44.7.41,30.1c-.2-.94-.28-1.9-.41-2.86V24c0-.14.07-.29.09-.43.17-1.15.27-2.32.52-3.46A25.61,25.61,0,1,1,30,50.87C29.1,51,28.16,51.13,27.22,51.26ZM25.54,35.11v-.17c1.11,0,2.23,0,3.35,0,.66,0,1.33,0,2-.1a35.55,35.55,0,0,0,3.72-.41A4,4,0,0,0,38,30.8,32.36,32.36,0,0,0,37.94,20a3.41,3.41,0,0,0-1.17-2.08A5.09,5.09,0,0,0,34,16.73a78.35,78.35,0,0,0-13.44-.27,25.67,25.67,0,0,0-3.92.41,4,4,0,0,0-3.41,3.44,33.69,33.69,0,0,0,0,10.7,3.67,3.67,0,0,0,1.09,2.24,4.72,4.72,0,0,0,2.81,1.29C20,34.76,22.75,34.92,25.54,35.11Z"/>
              <path class="fill-white" d="M25.54,35.11c-2.79-.19-5.59-.35-8.38-.57a4.72,4.72,0,0,1-2.81-1.29A3.67,3.67,0,0,1,13.26,31a33.69,33.69,0,0,1,0-10.7,4,4,0,0,1,3.41-3.44,25.67,25.67,0,0,1,3.92-.41A78.35,78.35,0,0,1,34,16.73a5.09,5.09,0,0,1,2.76,1.19A3.41,3.41,0,0,1,37.94,20,32.36,32.36,0,0,1,38,30.8a4,4,0,0,1-3.39,3.62,35.55,35.55,0,0,1-3.72.41c-.67.06-1.34.09-2,.1-1.12,0-2.24,0-3.35,0ZM22.59,20.76v9.78l8-4.9Z"/>
              <path class="fill-hydrate" d="M22.59,20.76l8,4.88-8,4.9Z"/>
            </svg>
          </a>
        </div>
      </div>
    </div>
  </div>

  <div id="how-to-find" class="mt-20 mb-20">
    <HowToFind />
  </div>
</template>
